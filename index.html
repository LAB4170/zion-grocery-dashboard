<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zion Groceries - Dashboard</title>
<link rel="stylesheet" href="styles/css/main.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
</head>
<body>
<div class="container">
    <!-- Sidebar will be loaded here -->
    <div id="sidebar-container"></div>

    <div class="main-content">
        <!-- Dashboard section will be loaded here -->
        <div id="dashboard-container"></div>
        
        <!-- Sales section will be loaded here -->
        <div id="sales-container"></div>
        <!-- Sales Settings section will be loaded here -->
        <div id="sales-settings-container"></div>
        <!-- Sales Reports section will be loaded here -->
        <div id="sales-reports-container"></div>
        <!-- Expenses section will be loaded here -->
        <div id="expenses-container"></div>
        <!-- Debts section will be loaded here -->
        <div id="debts-container"></div>
        <!-- M-Pesa section will be loaded here -->
        <div id="mpesa-container"></div>
    </div>
</div>

<!-- Modal containers will be loaded here -->
<div id="modals-container"></div>

<script src="scripts/utils.js"></script>
<script src="scripts/navigation.js"></script>
<script src="scripts/modals.js"></script>
<script src="scripts/products.js"></script>
<script src="scripts/sales.js"></script>
<script src="scripts/expenses.js"></script>
<script src="scripts/debts.js"></script>
<script src="scripts/mpesa.js"></script>
<script src="scripts/dashboard.js"></script>
<script src="scripts/reports.js"></script>
<script src="scripts/system-test.js"></script>
<script src="scripts/main.js"></script>

<script>
// Load all partials and modals
document.addEventListener('DOMContentLoaded', function() {
    loadPartial('partials/sidebar.html', 'sidebar-container');
    loadPartial('partials/dashboard.html', 'dashboard-container');
    loadPartial('partials/sales.html', 'sales-container'); // Corrected
    loadPartial('partials/sales-settings.html', 'sales-settings-container');
    loadPartial('partials/sales-reports.html', 'sales-reports-container');
    loadPartial('partials/expenses.html', 'expenses-container');
    loadPartial('partials/debts.html', 'debts-container');
    loadPartial('partials/mpesa.html', 'mpesa-container');
    
    // Load modals
    loadModals();
});


function loadPartial(url, containerId) {
    fetch(url)
        .then(response => response.text())
        .then(html => {
            const container = document.getElementById(containerId);
            if (container) {
                container.innerHTML = html;
            } else {
                console.error('Container not found:', containerId);
            }
        })
        .catch(error => console.error('Error loading partial:', error));
}

function loadModals() {
    const modalFiles = [
        'modals/sales-modal.html',
        'modals/product-modal.html',
        'modals/expense-modal.html',
        'modals/debt-modal.html'
    ];
    
    Promise.all(modalFiles.map(file => fetch(file).then(r => r.text())))
        .then(htmlArray => {
            const modalsContainer = document.getElementById('modals-container');
            if (modalsContainer) {
                modalsContainer.innerHTML = htmlArray.join('');
            } else {
                console.error('Modals container not found');
            }
        })
        .catch(error => console.error('Error loading modals:', error));
}
</script>
</body>
</html>
